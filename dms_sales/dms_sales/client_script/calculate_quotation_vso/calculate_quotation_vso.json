{
 "creation": "2026-02-15 22:00:00.000000",
 "docstatus": 0,
 "doctype": "Client Script",
 "dt": "VSO",
 "enabled": 1,
 "idx": 0,
 "modified": "2026-02-15 22:00:00.000000",
 "modified_by": "amirul.zulkefli@mydotconsulting.com",
 "module": "DMS Sales",
 "name": "Calculate Quotation VSO",
 "owner": "amirul.zulkefli@mydotconsulting.com",
 "script": "frappe.ui.form.on('VSO', {\n    refresh: function(frm) {\n        frm.cscript['selling_price_standard_body'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n        };\n\n        frm.cscript['road_tax2'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n        };\n\n        frm.cscript['ownership_claim'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n        };\n\n        frm.cscript['registration_fees'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n        };\n\n        frm.cscript['number_plate'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n             minusTotal(frm);\n        };\n        frm.cscript['insurance_perodua_total_protect'] = function() {\n            calculateSubTotal(frm);\n            calculateTotalSalesPrice(frm);\n            minusTotal(frm);\n            \n        };\n        \n        frm.cscript['rebate_discount'] = function() {\n            minusTotal(frm);\n        };\n        frm.cscript['booking_fee'] = function() {\n            minusTotal(frm);\n        };\n        frm.cscript['loan_approved'] = function() {\n            minusTotal(frm);\n        };\n        \n        \n    \n        \n    }\n});\n\n// Function to calculate sub_total based on net_selling_price and additional_perodua_accessories\nfunction calculateSubTotal(frm) {\n    var selling_price_standard_body = frm.doc.selling_price_standard_body || 0;\n    var road_tax2 = frm.doc.road_tax2 || 0;\n    var ownership_claim = frm.doc.ownership_claim || 0;\n     var registration_fees = frm.doc.registration_fees || 0;\n      var number_plate = frm.doc.number_plate || 0;\n\n    // Perform the calculation\n    var subTotal = selling_price_standard_body + road_tax2 + ownership_claim + registration_fees + number_plate;\n    // Set the calculated value to the sub_total field\n    frm.set_value('retail_price_without_insurance', subTotal);\n}\n\n// Function to calculate total_sales_price based on sub_total and other fields\nfunction calculateTotalSalesPrice(frm) {\n    var subTotal = frm.doc.retail_price_without_insurance || 0;\n    var insurance_perodua_total_protect = frm.doc.insurance_perodua_total_protect || 0;\n\n    // Perform the calculation\n    var totalSalesPrice = subTotal + insurance_perodua_total_protect;\n    // Set the calculated value to the total_sales_price field\n    frm.set_value('total_otr_with_insurance', totalSalesPrice);\n}\n\nfunction minusTotal(frm) {\n    var totalSalesPrices = frm.doc.total_otr_with_insurance || 0;\n    var rebate_discount = frm.doc.rebate_discount || 0;\n    var booking_fee = frm.doc.booking_fee || 0;\n    var loan_approved = frm.doc.loan_approved || 0;\n\n    // Perform the calculation\n    var totalSalesPricess = totalSalesPrices - rebate_discount - booking_fee - loan_approved;\n    // Set the calculated value to the total_sales_price field\n    frm.set_value('balance_down_payment', totalSalesPricess);\n}",
 "view": "Form"
}
