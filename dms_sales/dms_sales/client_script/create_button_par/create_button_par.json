{
 "creation": "2026-02-15 22:00:00.000000",
 "docstatus": 0,
 "doctype": "Client Script",
 "dt": "Car Stock Request",
 "enabled": 1,
 "idx": 0,
 "modified": "2026-02-15 22:00:00.000000",
 "modified_by": "amirul.zulkefli@mydotconsulting.com",
 "module": "DMS Sales",
 "name": "Create Button PAR",
 "owner": "amirul.zulkefli@mydotconsulting.com",
 "script": "function createnewPAR(frm) {\n    // Create a new Car Stock Request document\n    frappe.model.with_doctype('PAR', function() {\n        var newpar = frappe.model.get_new_doc('PAR');\n\n        // Set the sa_name field from Prospect Booking Form to VSO\n        //Customer Detail\n          newpar.vso_number = frm.doc.vso_number;\n          newpar.customer_name = frm.doc.customer_name;\n          newpar.customer_ic = frm.doc.ic_number;\n          newpar.sales_advisor = frm.doc.sales_advisor_name;\n          newpar.sales_advisor_ic = frm.doc.sa_id;\n          \n          newpar.sales_advisor_phone = frm.doc.sa_phone_number;\n          newpar.branch = frm.doc.outlet_name;\n          \n          //order particular\n          //left cd - vso\n          newpar.model_code = frm.doc.model;\n          newpar.engine_number = frm.doc.engine_no;\n          newpar.engine_cc = frm.doc.engine_cc;\n          newpar.chassis_number = frm.doc.chassis_no;\n          newpar.sales_type = frm.doc.sales_type;\n          newpar.term = frm.doc.term;\n          newpar.panel_co_branch = frm.doc.finance;\n          newpar.amount_financed = frm.doc.amount_finance;\n          newpar.finance_period = frm.doc.finance_period_months;\n     \n          \n          //Price structure\n          newpar.govt_approved_net_selling_price = frm.doc.net_selling_price;\n          newpar.metallic_paint = frm.doc.metallic_paint;\n          newpar.carrier_license__inspection_fee = frm.doc.carrier_licenseinspection_fee;\n          newpar.hp_ownership_claim = frm.doc.hpownership_claim;\n          newpar.insurance_premium = frm.doc.insurance_premium;\n          newpar.road_tax = frm.doc.road_tax;\n          newpar.registration_fee = frm.doc.registration_fees;\n          \n          newpar.description = frm.doc.description2;\n          newpar.engine_number = frm.doc.engine_no;\n          newpar.chassis_number = frm.doc.chassis_no;\n\n\n        // Open the new Car Stock Request document for editing\n        frappe.set_route('Form', 'PAR', newpar.name);\n    });\n}\n\nfrappe.ui.form.on('Car Stock Request', {\n    refresh: function (frm) {\n        \n         var user_roles = frappe.user_roles;\n       var is_sales_advisor = user_roles.includes(\"Sales Advisor\") || user_roles.includes(\"SA Manager\");\n\n        // Add a custom button to create a new Car Stock Request\n        if (!is_sales_advisor) {\n        frm.add_custom_button(__('PAR'), function () {\n            createnewPAR(frm);\n        });\n    }\n    }\n});",
 "view": "Form"
}
